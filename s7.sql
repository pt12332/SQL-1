-- Task 2 Create database by Phuoc Tran
DROP DATABASE IF EXISTS SOCCER;
CREATE DATABASE SOCCER;
USE SOCCER;
SHOW DATABASES;

-- Task 3 Create table by Phuoc Tran
USE SOCCER;
SHOW TABLES;

CREATE TABLE SEASON (
SEASON_ID CHAR (4) NOT NULL PRIMARY KEY,
SEASON_NAME CHAR(6) NOT NULL,
SEASON_YEAR DECIMAL(4,0) NOT NULL,
REGISTRATION_START DATE NOT NULL,
REGISTRATION_END DATE NOT NULL, 
SEASON_START DATE NOT NULL,
SEASON_END DATE NOT NULL);

CREATE TABLE DIVISION (
DIVISION_ID INT (3) NOT NULL PRIMARY KEY,
AGE INT(2) NOT NULL,
SEX CHAR(1) NOT NULL,
RANKING INT(2) NOT NULL,
DIVISION_EMAIL VARCHAR(30) NOT NULL UNIQUE,
DIVISION_PHONE CHAR(14) NOT NULL,
SEASON_ID CHAR (4) NOT NULL,
FOREIGN KEY (SEASON_ID) REFERENCES SEASON(SEASON_ID));

CREATE TABLE CLUB (
CLUB_ID CHAR (3) NOT NULL PRIMARY KEY,
CLUB_NAME VARCHAR (22) NOT NULL,
CLUB_EMAIL VARCHAR (30) NOT NULL,
CLUB_PHONE CHAR(14) NOT NULL,
CLUB_ABBR CHAR (5) NOT NULL);

CREATE TABLE COACH (
COACH_ID INT NOT NULL PRIMARY KEY,
COACH_FIRST_NAME VARCHAR(22) NOT NULL,
COACH_LAST_NAME VARCHAR(22) NOT NULL,
COACH_DOB DATE NOT NULL,
COACH_YEAR_STARTED INT NOT NULL,
COACH_ZIPCODE INT NOT NULL);

CREATE TABLE TEAM (
TEAM_ID CHAR (4) NOT NULL PRIMARY KEY,
BIRTH_YEAR DECIMAL (4,0) NOT NULL,
SEX CHAR (1) NOT NULL,
TEAM_NAME CHAR (20) NOT NULL,
TEAM_EMAIL VARCHAR (30) NOT NULL,
TEAM_PHONE CHAR(14) NOT NULL,
CLUB_ID CHAR(3) NOT NULL,
FOREIGN KEY (CLUB_ID) REFERENCES CLUB(CLUB_ID),
COACH_ID INT NOT NULL,
FOREIGN KEY (COACH_ID) REFERENCES COACH(COACH_ID));

CREATE TABLE ASSIGNMENT (
DIVISION_ID INT (3) NOT NULL,
TEAM_ID CHAR (4) NOT NULL,
PRIMARY KEY (DIVISION_ID, TEAM_ID),
FOREIGN KEY (DIVISION_ID) REFERENCES DIVISION(DIVISION_ID),
FOREIGN KEY (TEAM_ID) REFERENCES TEAM(TEAM_ID));

CREATE TABLE PLAYER (
PLAYER_ID INT(2) NOT NULL PRIMARY KEY,
PLAYER_LAST_NAME VARCHAR(22) NOT NULL,
PLAYER_DOB DATE NOT NULL,
PLAYER_JERSEY_NUMBER INT NOT NULL,
PLAYER_HOME_CITY VARCHAR (25) NOT NULL,
TEAM_ID CHAR(4) NOT NULL,
FOREIGN KEY (TEAM_ID) REFERENCES TEAM(TEAM_ID));


-- Task 4 Add data by Phuoc Tran
DESCRIBE SEASON;
DESCRIBE DIVISION;
DESCRIBE CLUB;
DESCRIBE TEAM;
DESCRIBE ASSIGNMENT;

INSERT INTO SEASON VALUES
("WI20", "Winter", 2020, "2018-10-01", "2019-10-15", "2018-11-01", "2018-12-30"),
("SP20", "Spring", 2020, "2019-01-01", "2019-01-15", "2019-02-01", "2019-03-30"),
("SU20", "Summer", 2020, "2019-05-01", "2019-05-15", "2019-06-01", "2019-07-30"),
("FA20", "Fall", 2020, "2020-08-01", "2020-08-15", "2020-09-01", "2020-10-30"),
("SU21", "Summer", 2020, "2020-05-01", "2020-05-15", "2020-06-01", "2020-06-30");

INSERT INTO DIVISION VALUES 
(101, 13, "M", 2, "winteru10@email.com","(751) 998-2218", "SP20" ),
(102, 11, "M", 1, "springu13@email.com", "(751) 434-3246", "SP20"),
(103, 15, "M", 5, "summeru15@email.com", "(751) 123-4567", "SU20"),
(104, 12, "F", 4, "springu12@email.com", "(175) 751-8822", "SP20"),
(105, 17, "F", 1, "summeru17@email.com", "(751) 123-4587", "SU20"),
(106, 23, "M", 3, "fallu23@email.com", "(175) 612-5447", "FA20");
 
INSERT INTO CLUB VALUES 
("T01", "Tigers", "tigers@mail.com", "(175) 221-9988", "tg"),
("E02", "Eagles", "eagles@email.com", "(175) 246-4343", "egls"),
("Z03", "Zebras", "zebras@mail.com", "(175) 612-9876", "zb"),
("H04", "Hippos", "hippos@mail.com", "(175) 612-5474", "hps"),
("E05", "Elephants", "elephants@mail.com", "(175) 474-6122", "elpts");

INSERT INTO COACH VALUES 
(06, "LE", "TRAN", "2020-12-30", 2019, 22015),
(07, "HUY", "NGUYEN", "2020-12-30", 2019, 22145),
(08, "KIM", "NGUYEN", "2020-12-30", 2000, 22103),
(09, "THUY", "TRAN", "2020-12-30", 2003, 22310),
(10, "TAM", "LE", "2020-12-30", 2018, 22787);


INSERT INTO TEAM VALUES 
("BL10", 2004, "M", "Blue", "blue@mail.com", "(542) 356-7865", "E02", 09),
("RE11", 1997, "M", "Red", "red@email.com", "(542) 631-2345", "E02", 06),
("GR12", 2005, "F", "Green", "green@mail.com", "(542) 430-9123", "Z03", 10),
("OR13", 2006, "M", "Orange", "orange@mail.com", "(542) 555-2323", "Z03", 07),
("YE14", 2002, "F", "Yellow", "yellow@mail.com", "(542) 121-4419", "H04", 08);

INSERT INTO ASSIGNMENT VALUES 
(102, "RE11"),
(103, "RE11"),
(106, "GR12"),
(103, "GR12"),
(101, "BL10"),
(106, "OR13");


INSERT INTO PLAYER VALUES 
(01, "JOHN","2018-12-30", 01,"VA","RE11"),
(02, "HOANG","2018-12-30", 01,"VA","GR12"),
(03, "NGAN","2018-12-30", 10,"MD","RE11"),
(04, "TRANG","2018-12-30", 11,"VA","GR12"),
(05, "HUNG","2018-12-30", 12,"DC","BL10");


DESCRIBE SEASON;
DESCRIBE DIVISION;
DESCRIBE CLUB;
DESCRIBE TEAM;
DESCRIBE ASSIGNMENT;
DESCRIBE COACH;
DESCRIBE PLAYER;


-- Task 5 Query the data by Phuoc Tran



SELECT COUNT(PLAYER_ID) 
FROM PLAYER, TEAM, ASSIGNMENT, DIVISION, SEASON
WHERE  PLAYER.TEAM_ID = TEAM.TEAM_ID
AND TEAM.TEAM_ID = ASSIGNMENT.TEAM_ID
AND ASSIGNMENT.DIVISION_ID = DIVISION.DIVISION_ID
AND DIVISION.SEASON_ID = SEASON.SEASON_ID 
AND SEASON_NAME = "Fall"
AND SEASON_YEAR = 2020;


SELECT COUNT(COACH.COACH_ID)
FROM TEAM, COACH
WHERE  COACH.COACH_ID = TEAM.COACH_ID
AND TEAM.CLUB_ID IN 
	(SELECT CLUB.CLUB_ID
FROM CLUB, TEAM, ASSIGNMENT, DIVISION, SEASON
WHERE  CLUB.CLUB_ID = TEAM.CLUB_ID
AND TEAM.TEAM_ID = ASSIGNMENT.TEAM_ID
AND ASSIGNMENT.DIVISION_ID = DIVISION.DIVISION_ID
AND DIVISION.SEASON_ID = SEASON.SEASON_ID 
AND SEASON_NAME = "Spring"
AND SEASON_YEAR = 2020);


SELECT PLAYER_LAST_NAME
FROM PLAYER
WHERE PLAYER_JERSEY_NUMBER IN (SELECT MIN(PLAYER_JERSEY_NUMBER) FROM PLAYER)
;


SELECT COACH_LAST_NAME, COACH_FIRST_NAME
FROM COACH
WHERE COACH_YEAR_STARTED IN (SELECT MAX(COACH_YEAR_STARTED) FROM COACH)
;










 

